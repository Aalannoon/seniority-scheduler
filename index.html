<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BanquetLogic - Employee Scheduler</title>
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">
</head>

<body>

<header class="app-header">
  <div class="logo-block">
    <div class="logo-icon-wrap" aria-hidden="true">
      <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Schedule grid">
        <g stroke="currentColor" stroke-width="1.25" fill="none" class="logo-icon-grid">
          <rect x="0.5" y="0.5" width="7" height="7" rx="0.5"/>
          <rect x="8.5" y="0.5" width="7" height="7" rx="0.5"/>
          <rect x="16.5" y="0.5" width="7" height="7" rx="0.5"/>
          <rect x="0.5" y="8.5" width="7" height="7" rx="0.5"/>
          <rect x="16.5" y="8.5" width="7" height="7" rx="0.5"/>
          <rect x="0.5" y="16.5" width="7" height="7" rx="0.5"/>
          <rect x="8.5" y="16.5" width="7" height="7" rx="0.5"/>
          <rect x="16.5" y="16.5" width="7" height="7" rx="0.5"/>
        </g>
        <rect x="8.5" y="8.5" width="7" height="7" rx="0.5" fill="currentColor" class="logo-icon-cell"/>
      </svg>
    </div>
    <div class="logo-text-col">
      <h1 class="logo-wordmark">BanquetLogic</h1>
      <p class="tagline">Intelligent Scheduling. Manager Driven.</p>
    </div>
  </div>
  <span class="week-header" id="weekHeader"></span>
</header>

<div id="absenceModalOverlay">
  <div id="absenceModal">
    <h3 id="absenceModalTitle">Time Off / Sick</h3>
    <p id="absenceModalEmpName" style="margin: 0 0 16px 0; font-size: 15px;"></p>
    <div class="edit-row">
      <label for="absenceStartDate">Start date</label>
      <input type="date" id="absenceStartDate" />
    </div>
    <div class="edit-row">
      <label for="absenceEndDate">End date (optional â€” leave blank for single day)</label>
      <input type="date" id="absenceEndDate" placeholder="Optional" />
    </div>
    <div class="edit-row">
      <label for="absenceType">Type</label>
      <select id="absenceType">
        <option value="sick">Sick</option>
        <option value="vacation">Vacation (Paid)</option>
        <option value="floating_holiday">Floating Holiday (Paid)</option>
        <option value="unpaid_vacation">Unpaid Vacation</option>
        <option value="requested_off">Request Off</option>
      </select>
    </div>
    <p style="font-size: 12px; color: var(--brand-text-muted); margin: 8px 0 0 0;">Request Off is visual only; it does not remove an existing shift until you change it to another type.</p>
    <div class="modal-actions">
      <button type="button" class="btn-primary" id="absenceConfirmBtn">Confirm</button>
      <button type="button" class="btn-secondary" id="absenceCancelBtn">Cancel</button>
    </div>
  </div>
</div>

<button type="button" onclick="toggleDarkMode()">Toggle Dark Mode</button>
<span id="tourPrintExportWrap" style="display: inline-flex; align-items: center; gap: 8px;">
  <label for="printPoolFilter" style="margin-left: 8px;">Print:</label>
  <select id="printPoolFilter" style="margin-left: 4px; padding: 4px 8px;" title="Affects PDF/print only">
    <option value="">All Pools</option>
  </select>
  <button type="button" class="print" onclick="printSchedule()">Print / Save PDF</button>
</span>

<div class="tabs">
  <button type="button" id="tabEmpBtn" onclick="showTab('employeesTab')">Employees</button>
  <button type="button" id="tabEvBtn" onclick="showTab('eventsTab')">Events</button>
  <button type="button" id="tabSchBtn" onclick="showTab('scheduleTab')">Schedule</button>
  <button type="button" id="tabAuditBtn" onclick="showTab('auditTab')">Audit Log</button>
  <button type="button" id="tabSettingsBtn" onclick="showTab('settingsTab')">Settings</button>
  <button type="button" id="tabSupportBtn" onclick="showTab('supportTab')">Support / Contact</button>
</div>

<!-- EMPLOYEES -->
<div id="employeesTab" class="tab">
<h2>Employees</h2>

<div id="employeesPoolSelector" class="employees-pool-selector" style="margin-bottom: 16px; display: flex; gap: 4px; flex-wrap: wrap;"></div>

<div style="margin-bottom: 15px; padding: 10px; background: #2e2e3d; border-radius: 8px;">
  <h3 style="margin-top: 0;">Add Employee Manually</h3>
  <div style="margin-bottom: 10px; display: flex; flex-wrap: wrap; align-items: flex-end; gap: 10px;">
    <input type="text" id="empName" placeholder="Name" />
    <div>
      <label for="empLaborPool" style="display: block; margin-bottom: 2px; font-size: 13px;">Labor Pool <span style="color:#e74c3c;">*</span></label>
      <select id="empLaborPool" required onchange="updateSeniorityPreFill()"></select>
    </div>
    <select id="empType"><option value="FT">FT</option><option value="PT">PT</option></select>
    <div>
      <label for="empSeniority" style="display: block; margin-bottom: 2px; font-size: 13px;">Seniority (within pool)</label>
      <input id="empSeniority" type="number" min="1" placeholder="Auto" style="width: 70px;" />
      <small style="display: block; margin-top: 2px; color: #95a5a6; font-size: 11px;">Auto-assigned; you can change it. Unique per labor pool.</small>
    </div>
    <select id="empPref">
      <option value="">No Pref</option>
      <option value="AM">AM</option>
      <option value="PM">PM</option>
    </select>
  </div>
  
  <div style="margin-top: 10px; padding: 8px; background: #1e1e2f; border-radius: 6px;">
    <strong>Optional Fields:</strong>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px; margin-top: 8px;">
      <input id="empEmail" type="email" placeholder="Email (for schedule send)" style="border: 2px solid #3498db;" />
      <input type="text" id="empEmployeeId" placeholder="Employee ID (optional)" />
      <div>
        <label for="empHireDate" style="display: block; margin-bottom: 4px; font-size: 13px;">Hire Date (optional)</label>
        <input id="empHireDate" type="date" placeholder="yyyy-mm-dd" title="Hire Date (optional)" />
        <small style="display: block; margin-top: 2px; color: #95a5a6; font-size: 12px;">When they started. Does not affect seniority.</small>
      </div>
      <div>
        <label for="empBirthdate" style="display: block; margin-bottom: 4px; font-size: 13px;">Birthday (optional)</label>
        <input id="empBirthdate" type="date" placeholder="yyyy-mm-dd" title="Birthday (optional)" />
        <small style="display: block; margin-top: 2px; color: #95a5a6; font-size: 12px;">For reference only; not used in scheduling.</small>
      </div>
    </div>
    <small style="color: #95a5a6; display: block; margin-top: 5px;">
      ðŸ“§ Email required for one-click schedule sending. Other fields are optional.
    </small>
  </div>
  
  <button type="button" class="btn-primary" onclick="addEmployee()" style="margin-top: 10px;">Add Employee</button>
</div>

<div style="margin-bottom: 15px; padding: 10px; background: #2e2e3d; border-radius: 8px;">
  <h3 style="margin-top: 0;">Import Seniority List</h3>
  <p style="margin: 5px 0; font-size: 13px; color: #95a5a6;">
    Upload a CSV file or paste text with employee data
  </p>
  
  <div style="margin: 10px 0;">
    <button type="button" onclick="document.getElementById('importFile').click()" style="background: #27ae60;">
      ðŸ“ Upload CSV File
    </button>
    <input type="file" id="importFile" accept=".csv,.txt" style="display: none;" onchange="handleFileImport(event)" />
    
    <button type="button" onclick="openPasteImport()" style="background: #9b59b6;">
      ðŸ“‹ Paste Text
    </button>
    
    <button type="button" onclick="exportEmployeeList()" style="background: #3498db;">
      ðŸ’¾ Export List
    </button>
    
    <button type="button" onclick="showImportHelp()" style="background: #95a5a6;">
      â“ Format Help
    </button>
  </div>
</div>

<table class="employees-table">
<thead>
<tr>
  <th>Name</th><th>Type</th><th>Email</th><th>Pref</th>
  <th>Max Days/Wk</th><th>Vacation</th><th>Day Prefs</th><th>Time Off</th><th>Sick</th><th>Actions</th>
</tr>
</thead>
<tbody id="employeesTable"></tbody>
</table>
</div>

<div id="employeeEditModalOverlay" class="employee-edit-overlay">
  <div id="employeeEditModal">
    <h3 id="employeeEditTitle">Edit employee</h3>
    <p id="employeeEditName" style="margin: 0 0 16px 0; font-size: 15px;"></p>
    <div class="edit-row">
      <label for="employeeEditType">Full-time / Part-time</label>
      <select id="employeeEditType">
        <option value="FT">Full-time (FT)</option>
        <option value="PT">Part-time (PT)</option>
      </select>
    </div>
    <div class="edit-row">
      <label for="employeeEditLaborPool">Labor Pool</label>
      <select id="employeeEditLaborPool"></select>
    </div>
    <div class="edit-row">
      <label for="employeeEditPref">AM / PM preference</label>
      <select id="employeeEditPref">
        <option value="">No preference</option>
        <option value="AM">AM (morning)</option>
        <option value="PM">PM (afternoon)</option>
      </select>
    </div>
    <div class="edit-row">
      <label for="employeeEditSeniority">Seniority (within pool, 1 = highest)</label>
      <input type="number" id="employeeEditSeniority" min="1" style="width: 80px;" />
      <small class="edit-helper">Override will be logged in the audit log.</small>
    </div>
    <div class="edit-row">
      <label><input type="checkbox" id="employeeEditSick" /> Mark as sick (unavailable this week)</label>
    </div>
    <p style="font-size: 12px; color: #95a5a6; margin: 12px 0 0 0;">Changes apply to future schedule generation only. Existing shifts are not changed.</p>
    <div class="edit-actions">
      <button type="button" class="save-btn btn-primary" id="employeeEditSaveBtn">Save Changes</button>
      <button type="button" class="cancel-btn" id="employeeEditCancelBtn">Cancel</button>
    </div>
  </div>
</div>

<!-- EVENTS -->
<div id="eventsTab" class="tab">
<h2>Events</h2>

<input type="text" id="eventName" placeholder="Event Name" />
<input id="eventDate" type="date" />
<label for="eventStart" class="event-time-label">Start Time</label>
<input id="eventStart" type="time" placeholder="--:--" onchange="autoRecommendStaff()" aria-label="Start Time" />
<label for="eventEnd" class="event-time-label">End Time</label>
<input id="eventEnd" type="time" placeholder="--:--" onchange="autoRecommendStaff()" aria-label="End Time" />
<input id="eventGuests" type="number" placeholder="Guests" oninput="autoRecommendStaff()" />

<select id="eventService" onchange="autoRecommendStaff()"></select>
<p class="event-type-helper">Affects staffing ratios and scheduling logic</p>

<div class="event-pool-reqs-section" style="margin-top: 12px;">
  <label style="display: block; margin-bottom: 6px; font-size: 13px;">Labor pool requirements</label>
  <p class="event-type-helper" style="margin: 0 0 8px 0;">Which pools are needed and how many (e.g. 1 Cashier, 2 Housemen).</p>
  <div id="eventLaborPoolReqsContainer"></div>
  <button type="button" onclick="addEventPoolReqRow()" style="margin-top: 6px;">Add pool requirement</button>
</div>

<p style="margin-top: 12px;"><label style="display: inline-flex; align-items: center; gap: 8px; cursor: pointer;"><input type="checkbox" id="eventCashBar" /> Cash Bar</label><br><small class="event-type-helper">When enabled, the schedule will show a non-binding cashier recommendation for this event.</small></p>

<input id="eventStaff" type="number" placeholder="Staff Needed (legacy)" style="margin-top: 8px;" />
<button type="button" id="eventSubmitBtn" class="btn-primary" onclick="addEvent()">Add Event</button>

<table class="events-table">
<thead>
<tr>
  <th>Name</th><th>Date</th><th>Time</th>
  <th>Guests</th><th>Service</th><th>Staff</th>
  <th>Edit</th><th>Delete</th>
</tr>
</thead>
<tbody id="eventsTable"></tbody>
</table>
</div>

<!-- SCHEDULE -->
<div id="scheduleTab" class="tab">
<h2>Schedule</h2>

<div class="schedule-pool-filter-wrap" id="tourSchedulePoolFilterWrap" style="margin-bottom: 10px;">
  <label for="schedulePoolFilter">View:</label>
  <select id="schedulePoolFilter" style="margin-left: 6px; padding: 6px 10px;" title="Filter schedule by labor pool (on-screen only)">
    <option value="">All Pools</option>
  </select>
</div>

<div class="schedule-actions">
  <span class="schedule-action-group">
    <button type="button" onclick="changeWeek(-1)">â¬… Previous Week</button>
    <button type="button" onclick="changeWeek(1)">Next Week âž¡</button>
  </span>
  <span class="schedule-action-sep" aria-hidden="true">|</span>
  <span class="schedule-action-group">
    <button type="button" class="btn-primary" onclick="generateSchedule()">Generate</button>
    <button type="button" class="btn-secondary" onclick="regenerateSchedule()">Regenerate</button>
  </span>
  <span class="schedule-action-sep" aria-hidden="true">|</span>
  <span class="schedule-action-group">
    <button type="button" id="globalLockBtn" onclick="toggleGlobalLock()" style="background:#f39c12;">ðŸ”“ Unlock Schedule</button>
    <span id="scheduleLockHelperText" class="schedule-lock-helper">Edits enabled â€” changes will affect assignments</span>
    <button type="button" onclick="emailSchedulesToAll()" style="background:#27ae60;">ðŸ“§ Email Schedules</button>
    <button type="button" onclick="showGenerationRules()" style="background:#9b59b6;">ðŸ“‹ Generation Rules</button>
    <button type="button" onclick="showConflictReport()" id="conflictReportBtn" style="background:#e74c3c; display:none;">âš ï¸ Conflicts</button>
    <button type="button" onclick="exportScheduleToCSV()" style="background:#16a085;">ðŸ“¥ Export CSV</button>
    <button type="button" onclick="openApplyRecommendationsModal()" style="background:#8e44ad;">Apply Recommendations</button>
    <span id="applyRecommendationsUndoWrap" style="display:none; margin-left: 8px;">
      <button type="button" id="applyRecommendationsUndoBtn" onclick="undoApplyRecommendations()" style="background:#c0392b;">Undo Apply Recommendations</button>
    </span>
  </span>
</div>
<p class="schedule-generate-note" style="margin: 6px 0 0 0; font-size: 12px; color: var(--brand-text-muted, #95a5a6);">The generated schedule is a starting draft. Managers should review for accuracy, preferences, and operational needs before publishing.</p>

<div id="applyRecommendationsModalOverlay" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 10000;">
  <div id="applyRecommendationsModal" style="background: #2c3e50; padding: 24px; border-radius: 8px; min-width: 320px; max-width: 90%;">
    <h3 style="margin-top: 0;">Apply Recommendations</h3>
    <p id="applyRecommendationsModalText">This will assign the recommended staff for the selected role to shifts this week, in seniority order. Only the selected role is affected. Assignments can be undone immediately after.</p>
    <p style="margin-top: 12px;"><label>Role: </label>
      <select id="applyRecommendationsRole">
        <option value="cashiers">Cashiers</option>
        <option value="housemen">Housemen</option>
      </select>
    </p>
    <div style="margin-top: 16px; display: flex; gap: 8px; justify-content: flex-end;">
      <button type="button" onclick="closeApplyRecommendationsModal()">Cancel</button>
      <button type="button" id="applyRecommendationsConfirmBtn" onclick="confirmApplyRecommendations()">Apply</button>
    </div>
  </div>
</div>

<p id="scheduleManagerNotice" class="schedule-manager-notice" style="margin: 8px 0; padding: 10px 12px; background: rgba(52, 152, 219, 0.2); border-left: 4px solid #3498db; border-radius: 4px;">Schedule auto-generated. Please review for overtime and preferences. Adjustments may be required. Fine-tune rules in Settings.</p>
<div id="scheduleOvertimeBanner" style="display: none; margin: 8px 0; padding: 10px 12px; background: rgba(230, 126, 34, 0.25); border-left: 4px solid #e67e22; border-radius: 4px;">
  <strong>Overtime suggested â€” review required.</strong>
  <p id="scheduleOvertimeBannerText" style="margin: 6px 0 0 0; font-size: 14px;"></p>
</div>
<div id="scheduleSettingsWarning" style="display: none; margin: 8px 0; padding: 10px 12px; background: rgba(241, 196, 15, 0.25); border-left: 4px solid #f1c40f; border-radius: 4px;">
  Schedule accuracy depends on employee preferences and availability. Review settings for best results.
</div>
<p class="schedule-grid-helper">Click a cell to assign an employee to an event or mark time off</p>
<p class="schedule-drag-tip" style="margin: 4px 0 8px 0; font-size: 12px; color: var(--brand-text-muted, #95a5a6);">Tip: You can drag and drop shifts to move or swap them.</p>
<div class="schedule-container">
  <table id="scheduleTable"></table>
</div>

<div id="laborCostPanel" class="labor-cost-panel" style="margin-top: 16px; padding: 12px 16px; background: rgba(0,0,0,0.15); border-radius: 8px; border: 1px solid var(--brand-border, #444);">
  <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px; margin-bottom: 8px;">
    <strong>Estimated labor cost (this week)</strong>
    <button type="button" id="laborCostToggleBtn" onclick="toggleLaborCostPanel()" style="padding: 4px 10px; font-size: 12px;">Hide</button>
  </div>
  <div id="laborCostContent">
    <div id="laborCostByPool"></div>
    <p id="laborCostTotal" style="margin: 8px 0 4px 0; font-weight: 600;"></p>
    <p class="labor-cost-disclaimer" style="margin: 0; font-size: 12px; color: var(--brand-text-muted);">Planning estimate only. Not payroll. Gratuities and other adjustments are not included.</p>
  </div>
</div>
<div id="laborCostShowWrap" style="display: none; margin-top: 10px;">
  <button type="button" onclick="toggleLaborCostPanel()" style="padding: 6px 12px; font-size: 12px;">Show labor cost</button>
</div>
</div>

<!-- AUDIT LOG -->
<div id="auditTab" class="tab">
<h2>Audit Log</h2>

<div class="audit-filters">
  <div class="audit-filters-inputs">
    <input type="text" id="auditEmployee" placeholder="Filter by employee" />
    <input id="auditDate" type="date" placeholder="Filter by date" />
  </div>
  <div class="audit-filters-actions">
    <button type="button" class="btn-primary" onclick="filterAuditLog()">Filter</button>
    <button type="button" class="btn-secondary" onclick="clearAuditFilter()">Clear filter</button>
  </div>
</div>

<div id="auditLogContainer"></div>
</div>

<!-- SETTINGS -->
<div id="settingsTab" class="tab">
<h2>Settings</h2>

<div class="settings-info-card" role="region" aria-labelledby="settings-info-card-title">
  <div>
    <h3 id="settings-info-card-title" class="settings-info-card-title">Need something different?</h3>
    <p class="settings-info-card-body">BanquetLogic is designed to adapt to your operation. Customize employee types, labor pools, and event types to fit your venue â€” or remove anything you don't use.</p>
  </div>
</div>

<div class="settings-section">
  <h3>Shift Assignment Style</h3>
  <p class="assignment-style-intro">Choose how shifts are assigned when generating schedules:</p>
  
  <div class="assignment-style-options">
    <label for="assignmentStyle_strict" class="assignment-option">
      <input type="radio" id="assignmentStyle_strict" name="assignmentStyle" value="strict" checked>
      <div class="assignment-option-content">
        <strong class="assignment-option-title">Strict Seniority</strong>
        <p class="assignment-option-desc">Higher-seniority employees are always assigned first. Seniority 1 gets all available shifts before Seniority 2, and so on. Preferences are only respected if they don't conflict with seniority priority.</p>
      </div>
    </label>
    <label for="assignmentStyle_balanced" class="assignment-option">
      <input type="radio" id="assignmentStyle_balanced" name="assignmentStyle" value="balanced">
      <div class="assignment-option-content">
        <strong class="assignment-option-title">Seniority + Balanced Coverage</strong>
        <p class="assignment-option-desc">Seniority is prioritized, but shifts are balanced across employee groups (FT/PT). Prevents one group from getting all shifts while others are eligible. Better distribution while still respecting seniority within each group.</p>
      </div>
    </label>
    <label for="assignmentStyle_fair" class="assignment-option">
      <input type="radio" id="assignmentStyle_fair" name="assignmentStyle" value="fair">
      <div class="assignment-option-content">
        <strong class="assignment-option-title">Fair Distribution</strong>
        <p class="assignment-option-desc">Shifts distributed as evenly as possible across all eligible employees. Everyone gets similar hours regardless of seniority. Seniority is only used as a tie-breaker when two employees have equal hours.</p>
      </div>
    </label>
  </div>
  
  <h3 style="margin-top: 20px;">Staffing ratios (recommendations only)</h3>
  <p class="event-type-helper">These affect suggested staff counts only. They do not force assignments.</p>
  <p style="margin-top: 10px;"><label>Servers:</label> <span id="settingsServersRatioLabel">Uses event type ratios (e.g. 1 server per 20 guests for Plated Service). Edit in Event Types below.</span></p>
  <p style="margin-top: 10px;"><label>Cashiers:</label> 1 cashier per <input type="number" id="settingsCashierRatio" min="1" value="150" style="width: 70px; padding: 6px;" /> guests</p>
  <p style="margin-top: 10px;"><label>Housemen:</label>
    <label style="display: inline-flex; align-items: center; gap: 6px; margin-left: 8px;"><input type="radio" name="housemenRatioMode" value="per_guests" /> 1 houseman per <input type="number" id="settingsHousemenPerGuests" min="1" value="100" style="width: 60px; padding: 6px;" /> guests</label>
    <label style="display: inline-flex; align-items: center; gap: 6px; margin-left: 12px;"><input type="radio" name="housemenRatioMode" value="flat" /> Flat: <input type="number" id="settingsHousemenFlat" min="0" value="2" style="width: 50px; padding: 6px;" /> per event</label>
  </p>
  <button type="button" class="btn-primary" onclick="saveSettings()">Save Settings</button>
</div>

<div class="settings-section" id="laborPoolsSection">
  <h3>Labor Pools</h3>
  <p>Create pools (e.g. Servers, Cashiers, Housemen). Each employee is assigned to one pool. Seniority is tracked separately within each pool. Control whether a pool can be scheduled and whether it appears in event requirements.</p>
  
  <table class="settings-table event-types-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Default wage</th>
        <th>Can schedule</th>
        <th>In events</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="laborPoolsTableBody"></tbody>
  </table>
  <button type="button" onclick="openLaborPoolModal()" class="event-type-add-btn">Add labor pool</button>
</div>

<div id="laborPoolModalOverlay" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 10000; align-items: center; justify-content: center;" onclick="if(event.target===this) closeLaborPoolModal();">
  <div id="laborPoolModal" style="background: #2c3e50; padding: 24px; border-radius: 8px; min-width: 320px; max-width: 90%;" onclick="event.stopPropagation();">
    <h3 style="margin-top: 0;" id="laborPoolModalTitle">Add labor pool</h3>
    <input type="hidden" id="laborPoolEditId" value="" />
    <div style="margin-bottom: 12px;">
      <label for="laborPoolName" style="display: block; margin-bottom: 4px;">Name</label>
      <input type="text" id="laborPoolName" placeholder="e.g. Servers" style="width: 100%; padding: 8px; box-sizing: border-box;" />
    </div>
    <div style="margin-bottom: 12px;">
      <label for="laborPoolWage" style="display: block; margin-bottom: 4px;">Default hourly wage</label>
      <input type="number" id="laborPoolWage" min="0" step="0.01" value="0" style="width: 120px; padding: 8px;" />
    </div>
    <div style="margin-bottom: 12px;">
      <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
        <input type="checkbox" id="laborPoolCanSchedule" checked />
        Can be scheduled
      </label>
    </div>
    <div style="margin-bottom: 16px;">
      <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
        <input type="checkbox" id="laborPoolAppearsInEvents" checked />
        Appears in events
      </label>
    </div>
    <div style="display: flex; gap: 8px; justify-content: flex-end;">
      <button type="button" onclick="closeLaborPoolModal()">Cancel</button>
      <button type="button" class="btn-primary" onclick="saveLaborPoolFromModal()">Save Changes</button>
    </div>
  </div>
</div>

<div class="settings-section" id="eventTypesSection">
  <h3>Event Types</h3>
  <p>Define event types and staffing ratios (1 server per X guests). Inactive types are hidden when creating events but existing events keep displaying correctly.</p>
  
  <table class="settings-table event-types-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>1 Server per ___ Guests</th>
        <th>Active</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="eventTypesTableBody"></tbody>
  </table>
  <button type="button" onclick="openEventTypeModal()" class="event-type-add-btn">Add event type</button>
</div>

<div id="eventTypeModalOverlay" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 10000; align-items: center; justify-content: center;">
  <div id="eventTypeModal" style="background: #2c3e50; padding: 24px; border-radius: 8px; min-width: 320px; max-width: 90%;">
    <h3 style="margin-top: 0;" id="eventTypeModalTitle">Add event type</h3>
    <input type="hidden" id="eventTypeEditId" value="" />
    <div style="margin-bottom: 12px;">
      <label for="eventTypeName" style="display: block; margin-bottom: 4px;">Name</label>
      <input type="text" id="eventTypeName" placeholder="e.g. Plated Service" style="width: 100%; padding: 8px; box-sizing: border-box;" />
    </div>
    <div style="margin-bottom: 16px;">
      <label for="eventTypeGuestsPerServer" style="display: block; margin-bottom: 4px;">1 Server per ___ Guests</label>
      <input type="number" id="eventTypeGuestsPerServer" min="1" value="20" style="width: 100px; padding: 8px;" />
    </div>
    <div style="display: flex; gap: 8px; justify-content: flex-end;">
      <button type="button" onclick="closeEventTypeModal()">Cancel</button>
      <button type="button" class="btn-primary" onclick="saveEventTypeFromModal()">Save Changes</button>
    </div>
  </div>
</div>

<div class="settings-section" id="dataManagementSection">
  <h3>Data Management</h3>
  <p>Back up your data to a file or restore from a previous backup. The app also saves automatic backups when you make changes.</p>
  <div class="data-mgmt-actions">
    <div class="data-mgmt-group">
      <span class="data-mgmt-group-label">Export / Import</span>
      <div class="data-mgmt-buttons">
        <button type="button" onclick="exportData()">Export Data</button>
        <button type="button" onclick="document.getElementById('importDataFile').click()">Import Data</button>
      </div>
    </div>
    <div class="data-mgmt-group">
      <span class="data-mgmt-group-label">Backup</span>
      <div class="data-mgmt-buttons">
        <button type="button" onclick="createManualBackup()">Create backup now</button>
        <button type="button" onclick="openRestoreBackupModal()">Restore from Backup</button>
      </div>
    </div>
    <input type="file" id="importDataFile" accept=".json,application/json" style="display: none;" onchange="handleImportFile(event)" />
  </div>
  <p class="data-mgmt-note">Import replaces everything currently in the app with the file you choose. Restore from Backup uses a backup saved automatically or one you exported earlier.</p>
</div>

<div id="restoreBackupModalOverlay" style="display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 10000; align-items: center; justify-content: center;" onclick="if(event.target===this) closeRestoreBackupModal();">
  <div id="restoreBackupModal" style="background: #2c3e50; padding: 24px; border-radius: 8px; min-width: 360px; max-width: 95%; max-height: 85vh; overflow: auto;" onclick="event.stopPropagation();">
    <h3 style="margin-top: 0;">Restore from Backup</h3>
    <p style="color: var(--brand-text-muted); font-size: 13px; margin-bottom: 16px;">Choose a backup to restore or export to a file.</p>
    <div id="restoreBackupList"></div>
    <div style="margin-top: 16px;">
      <button type="button" onclick="closeRestoreBackupModal()">Close</button>
    </div>
  </div>
</div>

<div class="settings-section settings-section-danger">
  <h3 class="danger-heading">Admin: Clear All Data</h3>
  <p>Reset the app to a completely fresh state. Use this to remove all employees, events, schedules (all weeks), and audit log.</p>
  <p class="danger-warning">This action cannot be undone. All data will be permanently deleted.</p>
  <button type="button" onclick="clearAllData()" class="btn-danger">Clear All Employee Data</button>
</div>
</div>

<!-- SUPPORT / CONTACT -->
<div id="supportTab" class="tab">
  <div class="support-page">
    <h2>Support &amp; Contact</h2>

    <div class="support-doc-card" style="margin-bottom: 24px; padding: 18px 20px; background: var(--brand-bg-elevated); border: 1px solid var(--brand-border); border-radius: 10px;">
      <h3 class="support-form-title" style="margin-top: 0;">User Guide</h3>
      <p style="margin: 0 0 12px 0; font-size: 14px; color: var(--brand-text-muted);">A complete feature guide with step-by-step instructions. Open the guide and use your browserâ€™s Print â†’ Save as PDF to download a PDF copy.</p>
      <a href="support/BanquetLogic-User-Guide.html" target="_blank" rel="noopener noreferrer" class="btn-primary" style="display: inline-block; padding: 10px 18px; text-decoration: none; border-radius: 8px; font-weight: 500;">Open BanquetLogic User Guide</a>
    </div>

    <p class="support-intro">
      Use this form to report issues, suggest improvements, or ask a question. Your message opens in your email clientâ€”only what you type here is sent. No employee or schedule data is ever included.
    </p>

    <div class="support-form-card">
      <h3 class="support-form-title">Send a message</h3>

      <div class="support-field">
        <label for="supportCategory">Category</label>
        <select id="supportCategory">
          <option value="Bug">Bug report</option>
          <option value="Suggestion">Feature suggestion</option>
          <option value="Question">Question</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="support-field">
        <label for="supportSubject">Subject <span class="required">*</span></label>
        <input type="text" id="supportSubject" placeholder="e.g. Schedule not saving after refresh" />
        <span class="support-helper">A short summary helps us route your message quickly.</span>
      </div>

      <div class="support-field">
        <label for="supportMessage">Message <span class="required">*</span></label>
        <textarea id="supportMessage" placeholder="Describe what happened or what youâ€™d like to see. For bugs, include steps to reproduce and your browser if possible." rows="6"></textarea>
        <span class="support-helper">The more detail you provide, the better we can help. Include steps to reproduce for bugs.</span>
      </div>

      <div class="support-privacy">
        <strong>Privacy:</strong> Only the text you enter above is used. We do not access or send any employee names, schedules, or other app data.
      </div>

      <button type="button" class="support-submit" onclick="submitSupport()">Send message</button>

      <div id="supportFeedback" class="support-feedback" role="status" aria-live="polite"></div>
    </div>

    <div class="support-alternatives">
      <h4>Other ways to reach us</h4>
      <p>
        Email: <a href="mailto:Alialannoon@gmail.com">Alialannoon@gmail.com</a>
      </p>
      <p class="support-response-time">
        We aim to respond within 1â€“2 business days.
      </p>
    </div>
  </div>
</div>

  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
  <script src="app.js"></script>
</body>
</html>

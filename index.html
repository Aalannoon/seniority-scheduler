<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Seniority Scheduler</title>

<style>
/* =========================
   GLOBAL / LAYOUT
========================= */
body {
  font-family: Arial, sans-serif;
  margin: 20px;
}

h1 {
  margin-bottom: 4px;
}

.tabs button {
  margin-right: 6px;
  padding: 6px 10px;
  cursor: pointer;
}

.tab {
  display: none;
  margin-top: 20px;
}

/* =========================
   TABLES
========================= */
table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 10px;
}

th, td {
  border: 1px solid #ccc;
  padding: 6px;
  text-align: center;
  vertical-align: middle;
}

.employee-row {
  border-top: 3px solid #000;
}

/* =========================
   SHIFT COLORS
========================= */
.shift-4 { background: #7bd389; }     /* green */
.shift-6 { background: #f4a261; }     /* orange */
.shift-8 { background: #f1e05a; }     /* yellow */
.shift-ot { background: #c77dff; }    /* purple */

/* =========================
   STATUS CELLS
========================= */
.status-vacation {
  background: #e0e0e0;
  font-style: italic;
}

.status-sick {
  background: #ffd6d6;
  font-style: italic;
}

/* =========================
   PRINT / PDF
========================= */
@media print {
  body { margin: 0; }
  .tabs, button { display: none; }
}
</style>
</head>

<body>

<h1 id="weekHeader"></h1>

<div class="tabs">
  <button onclick="showTab('employeesTab')">Employees</button>
  <button onclick="showTab('eventsTab')">Events</button>
  <button onclick="showTab('scheduleTab')">Schedule</button>
  <button onclick="window.print()">Export PDF</button>
</div>

<!-- =========================
     EMPLOYEES TAB
========================= -->
<div id="employeesTab" class="tab">
  <h2>Employees</h2>

  <input id="empName" placeholder="Name" />
  <select id="empType">
    <option value="FT">FT</option>
    <option value="PT">PT</option>
  </select>
  <input id="empSeniority" type="number" placeholder="Seniority (1 = highest)" />
  <input id="empPrefTime" type="time" />
  <button onclick="addEmployee()">Add Employee</button>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Seniority</th>
        <th>Pref Start</th>
        <th>Vacation</th>
        <th>Sick</th>
      </tr>
    </thead>
    <tbody id="employeesTable"></tbody>
  </table>
</div>

<!-- =========================
     EVENTS TAB (MANAGERS)
========================= -->
<div id="eventsTab" class="tab">
  <h2>Events (Manager Only)</h2>

  <input id="eventName" placeholder="Event Name" />
  <input id="eventDate" type="date" />
  <input id="eventGuests" type="number" placeholder="Guests" />
  <input id="eventStaffNeeded" type="number" placeholder="Staff Needed" />
  <input id="eventHours" type="number" step="0.5" placeholder="Event Hours" />
  <button onclick="addEvent()">Add Event</button>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Date</th>
        <th>Guests</th>
        <th>Staff Needed</th>
        <th>Hours</th>
      </tr>
    </thead>
    <tbody id="eventsTable"></tbody>
  </table>
</div>

<!-- =========================
     SCHEDULE TAB
========================= -->
<div id="scheduleTab" class="tab">
  <h2>Schedule</h2>
  <button onclick="generateSchedule()">Generate Schedule</button>
  <table id="scheduleTable"></table>
</div>

<script>
/* ==========================================================
   DATA MODELS (PERSISTENT)
========================================================== */

let employees = JSON.parse(localStorage.getItem("employees") || "[]");
let events = JSON.parse(localStorage.getItem("events") || "[]");

/*
Employee shape:
{
  name: string,
  type: "FT" | "PT",
  seniority: number,
  prefStart: "HH:MM" | "",
  vacation: boolean,
  sick: boolean
}

Event shape:
{
  name: string,
  date: "YYYY-MM-DD",
  guests: number,
  staffNeeded: number,
  hours: number
}
*/

function saveData() {
  localStorage.setItem("employees", JSON.stringify(employees));
  localStorage.setItem("events", JSON.stringify(events));
}

/* ==========================================================
   TAB CONTROL
========================================================== */
function showTab(id) {
  document.querySelectorAll(".tab").forEach(t => t.style.display = "none");
  document.getElementById(id).style.display = "block";
}

/* ==========================================================
   DATE HELPERS
========================================================== */
function getWeekStart(date = new Date()) {
  const d = new Date(date);
  const day = d.getDay() || 7; // Sun = 7
  if (day !== 1) d.setDate(d.getDate() - day + 1);
  return d;
}

function formatDateISO(date) {
  return date.toISOString().split("T")[0];
}

function getWeekDays() {
  const start = getWeekStart();
  const days = [];
  for (let i = 0; i < 7; i++) {
    const d = new Date(start);
    d.setDate(start.getDate() + i);
    days.push(d);
  }
  return days;
}

/* ==========================================================
   INITIAL UI
========================================================== */
showTab("employeesTab");
</script>

<!-- PART 1 END -->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seniority Scheduler</title>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f4f4f4; }
header { background:#222; color:#fff; padding:12px; text-align:center; }
nav { display:flex; background:#333; }
nav button {
  flex:1; padding:12px; background:#333; color:#fff; border:none;
}
nav button.active { background:#555; }
section { display:none; padding:15px; }
section.active { display:block; }
.card {
  background:#fff; padding:15px; margin-bottom:12px;
  border-radius:6px;
}
input, select, button {
  width:100%; padding:8px; margin-top:6px;
}
.list { border-top:1px solid #ddd; margin-top:10px; }
.item { padding:6px 0; border-bottom:1px solid #ddd; }
.small { font-size:0.9em; color:#555; }
.vacation { color:#c0392b; font-weight:bold; }
</style>
</head>

<body>

<header>
  <h2>Seniority Scheduler</h2>
</header>

<nav>
  <button class="active" onclick="showTab('employees')">Employees</button>
  <button onclick="showTab('events')">Events</button>
  <button onclick="showTab('vacations')">Vacations</button>
  <button onclick="showTab('schedule')">Schedule</button>
</nav>

<section id="employees" class="active">
  <div class="card">
    <h3>Add Employee</h3>
    <input id="empName" placeholder="Name">
    <select id="empType">
      <option value="full">Full-Time</option>
      <option value="part">Part-Time</option>
    </select>
    <input id="empSeniority" type="number" placeholder="Seniority (1 = highest)">
    <select id="empPref">
      <option>Morning</option>
      <option>Midday</option>
      <option>Night</option>
    </select>
    <button onclick="addEmployee()">Add Employee</button>
  </div>

  <div class="card">
    <h3>Employees</h3>
    <div id="employeeList" class="list"></div>
  </div>
</section>

<section id="events">
  <div class="card">
    <h3>Add Event</h3>
    <input id="eventName" placeholder="Event Name">
    <input id="eventDate" type="date">
    <input id="eventStart" type="time">
    <input id="eventEnd" type="time">

    <h4>Servers Needed</h4>
    <input id="needSetup" type="number" placeholder="Setup servers">
    <input id="needEvent" type="number" placeholder="Event servers">
    <input id="needCleanup" type="number" placeholder="Cleanup servers">

    <button onclick="addEvent()">Add Event</button>
  </div>

  <div class="card">
    <h3>Events</h3>
    <div id="eventList" class="list"></div>
  </div>
</section>

<section id="vacations">
  <div class="card">
    <h3>Add Vacation</h3>
    <select id="vacEmp"></select>
    <input id="vacDate" type="date">
    <button onclick="addVacation()">Add Vacation</button>
  </div>

  <div class="card">
    <h3>Vacation List</h3>
    <div id="vacationList" class="list"></div>
  </div>
</section>

<section id="schedule">
  <div class="card">
    <h3>Generate Schedule</h3>
    <button onclick="generateSchedule()">Generate</button>
    <div id="scheduleOutput"></div>
  </div>
</section>

<script>
let employees = JSON.parse(localStorage.getItem("employees")) || [];
let events = JSON.parse(localStorage.getItem("events")) || [];
let vacations = JSON.parse(localStorage.getItem("vacations")) || [];

function save() {
  localStorage.setItem("employees", JSON.stringify(employees));
  localStorage.setItem("events", JSON.stringify(events));
  localStorage.setItem("vacations", JSON.stringify(vacations));
}

function showTab(id) {
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.querySelectorAll("nav button").forEach(b => b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  event.target.classList.add("active");
}

/* EMPLOYEES */

function addEmployee() {
  if (!empName.value || !empSeniority.value) return;

  employees.push({
    name: empName.value,
    type: empType.value,
    seniority: parseInt(empSeniority.value),
    pref: empPref.value
  });

  employees.sort((a,b) => {
    if (a.type !== b.type) return a.type === "full" ? -1 : 1;
    return a.seniority - b.seniority;
  });

  save();
  renderEmployees();
  renderVacationEmployees();
}

function renderEmployees() {
  employeeList.innerHTML = employees.map(e =>
    `<div class="item">
      <strong>${e.name}</strong> (${e.type})<br>
      Seniority: ${e.seniority} | Pref: ${e.pref}
    </div>`
  ).join("");
}

/* EVENTS */

function addEvent() {
  events.push({
    name: eventName.value,
    date: eventDate.value,
    start: eventStart.value,
    end: eventEnd.value,
    setup: parseInt(needSetup.value || 0),
    main: parseInt(needEvent.value || 0),
    cleanup: parseInt(needCleanup.value || 0)
  });
  save();
  renderEvents();
}

function renderEvents() {
  eventList.innerHTML = events.map(e =>
    `<div class="item">
      <strong>${e.name}</strong><br>
      ${e.date} ${e.start}–${e.end}<br>
      Setup: ${e.setup}, Event: ${e.main}, Cleanup: ${e.cleanup}
    </div>`
  ).join("");
}

/* VACATIONS */

function renderVacationEmployees() {
  vacEmp.innerHTML = employees.map(e =>
    `<option value="${e.name}">${e.name}</option>`
  ).join("");
}

function addVacation() {
  if (!vacEmp.value || !vacDate.value) return;
  vacations.push({ name: vacEmp.value, date: vacDate.value });
  save();
  renderVacations();
}

function renderVacations() {
  vacationList.innerHTML = vacations.map(v =>
    `<div class="item vacation">
      ${v.name} — ${v.date}
    </div>`
  ).join("");
}

/* SCHEDULER */

function generateSchedule() {
  let output = "";

  events.forEach(ev => {
    output += `<h4>${ev.name} (${ev.date})</h4>`;

    let unavailable = vacations
      .filter(v => v.date === ev.date)
      .map(v => v.name);

    let availableEmployees = employees.filter(e => !unavailable.includes(e.name));

    let blocks = [
      { label:"Setup", need:ev.setup },
      { label:"Event", need:ev.main },
      { label:"Cleanup", need:ev.cleanup }
    ];

    blocks.forEach(b => {
      if (b.need === 0) return;

      output += `<strong>${b.label}</strong><ul>`;
      let assigned = 0;

      for (let e of availableEmployees) {
        if (assigned >= b.need) break;
        output += `<li>${e.name}</li>`;
        assigned++;
      }

      if (assigned < b.need) {
        output += `<li><em>Unfilled slots</em></li>`;
      }

      output += `</ul>`;
    });

    if (unavailable.length) {
      output += `<div class="vacation">On vacation: ${unavailable.join(", ")}</div>`;
    }
  });

  scheduleOutput.innerHTML = output;
}

renderEmployees();
renderEvents();
renderVacations();
renderVacationEmployees();
</script>

</body>
</html>
